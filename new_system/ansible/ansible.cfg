# Ansible Configuration
# Home Lab Infrastructure
# Dell XPS L701X - Proxmox VE 9

[defaults]

# Inventory
inventory = ./inventory/production/hosts.yml
# Use specific environment: ansible-playbook -i inventory/development/hosts.yml

# Roles path
roles_path = ./roles:~/.ansible/roles:/usr/share/ansible/roles

# Collections path
collections_path = ./collections:~/.ansible/collections

# Host key checking (disabled for lab environment)
host_key_checking = False

# SSH timeout
timeout = 30

# Retry files (disabled)
retry_files_enabled = False

# Gathering facts
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts
fact_caching_timeout = 86400  # 24 hours

# Display
stdout_callback = yaml
# Alternative: stdout_callback = minimal, oneline, debug
callbacks_enabled = profile_tasks, timer

# Ansible connection
transport = smart

# Become settings
become = True
become_method = sudo
become_user = root
become_ask_pass = False

# Privilege escalation
become_flags = -H -S

# Logging
log_path = ./ansible.log

# Error handling
any_errors_fatal = False

# Parallelism
forks = 10  # Run up to 10 tasks in parallel
serial = 0  # 0 = use all hosts (or specify number)

# Polling
poll_interval = 15

# Pipelining (performance optimization)
pipelining = True

# Control persistence
control_path_dir = ~/.ansible/cp
control_path = %(directory)s/ansible-ssh-%%h-%%p-%%r

# Deprecation warnings
deprecation_warnings = True
command_warnings = False

# Diff mode
diff_always = False

# Callback plugins
callback_whitelist = profile_tasks, timer, yaml

# Action plugins
action_plugins = /usr/share/ansible/plugins/action:~/.ansible/plugins/action

# ============================================================
# SSH Settings
# ============================================================

[ssh_connection]

# SSH arguments
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null

# Pipelining (reduces SSH connections)
pipelining = True

# SCP/SFTP
scp_if_ssh = smart
transfer_method = smart

# ControlPath
control_path_dir = ~/.ansible/cp
control_path = %(directory)s/ansible-ssh-%%h-%%p-%%r

# Retries
retries = 3

# ============================================================
# Privilege Escalation
# ============================================================

[privilege_escalation]

become = True
become_method = sudo
become_user = root
become_ask_pass = False

# ============================================================
# Colors
# ============================================================

[colors]

highlight = white
verbose = blue
warn = bright purple
error = red
debug = dark gray
deprecate = purple
skip = cyan
unreachable = red
ok = green
changed = yellow
diff_add = green
diff_remove = red
diff_lines = cyan

# ============================================================
# Inventory
# ============================================================

[inventory]

# Enable plugins
enable_plugins = host_list, script, auto, yaml, ini, toml

# Ignore files
unparsed_is_failed = False

# ============================================================
# Diff
# ============================================================

[diff]

# Always show diff
always = False

# Context lines
context = 3
