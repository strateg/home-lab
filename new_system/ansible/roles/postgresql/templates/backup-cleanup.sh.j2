#!/bin/bash
# PostgreSQL Backup Cleanup Script
# Managed by Ansible

set -euo pipefail

BACKUP_DIR="{{ postgresql_backup_dir }}"
RETENTION_DAYS="{{ postgresql_backup_retention_days }}"

# Remove backups older than retention period
find "$BACKUP_DIR" -name "postgresql_backup_*.sql.gz" -type f -mtime +"$RETENTION_DAYS" -delete

echo "Cleanup completed: removed backups older than $RETENTION_DAYS days"
