# L1 Foundation
# Part of Home Lab Topology v4.0.0
# Physical foundation: devices, interfaces, MACs, UPS
# Edit this file then regenerate: python3 scripts/regenerate-all.py

locations:
- id: home
  name: Home Lab
  type: home-office
  description: Single-host home lab setup
- id: portable
  name: Portable
  type: mobile
  description: Travel or temporary deployments
# Cloud locations
- id: oracle-frankfurt
  name: Oracle Cloud Frankfurt
  type: cloud
  provider: oracle
  region: eu-frankfurt-1
  description: Oracle Cloud Infrastructure - EU Frankfurt region (Always Free eligible)
- id: hetzner-nuremberg
  name: Hetzner Cloud Nuremberg
  type: cloud
  provider: hetzner
  region: nbg1
  description: Hetzner Cloud - Nuremberg datacenter

devices:
- id: gamayun
  name: Gamayun
  type: hypervisor
  role: compute
  model: Dell XPS L701X
  location: home
  description: Primary Proxmox VE host - Гамаюн (вещая птица)
  specs:
    cpu:
      model: Intel Core i3-M370
      cores: 2
      threads: 4
      speed_mhz: 2400
    memory:
      total_gb: 8
      type: DDR3
      upgradeable: false
    disks:
    - id: disk-ssd-system
      device: /dev/sda
      size_gb: 180
      type: ssd
      usage: Proxmox system + VMs/LXC thin pool
    - id: disk-hdd-data
      device: /dev/sdb
      size_gb: 500
      type: hdd
      usage: Backups, ISOs, VM/LXC templates
  interfaces:
  - id: if-eth-builtin
    name: eth-builtin
    type: pci-ethernet
    speed_mbps: 1000
    mac: auto-detect
    physical_name: enp3s0
    role: lan
    description: Built-in Ethernet to MikroTik LAN port
    note: Run 'ip link' on Proxmox to get actual interface name
  - id: if-eth-usb
    name: eth-usb
    type: usb-ethernet
    speed_mbps: 1000
    mac: auto-detect
    physical_name: enxXXXXXXXXXXXX
    role: reserved
    description: USB Ethernet adapter - reserved for OOB management or backup
    status: optional
    note: 'USB Ethernet uses predictable naming: enx<MAC>. Run ''ip link'' to discover.'
  power:
    max_watts: 65
    psu: Dell 65W AC adapter
  firmware:
    bios_version: A07
    updated: '2020-03-15'
- id: mikrotik-chateau
  name: MikroTik Chateau LTE7 ax
  type: router
  role: central-gateway
  model: S53UG+5HaxD2HaxD-TC&R11e-LTE7
  location: home
  description: Central router with WiFi 6, LTE failover, RouterOS v7 containers
  specs:
    cpu:
      model: Qualcomm IPQ-6010
      architecture: ARM64
      cores: 4
      speed_mhz: 1800
      speed_mode: auto (864-1800 MHz)
    memory:
      total_mb: 1024
      type: DDR
    storage:
      flash_mb: 128
      type: NAND
    usb:
      version: '2.0'
      type: Type-A
      max_current_ma: 1000
      note: For container storage (AdGuard, Tailscale)
  interfaces:
  - id: if-mikrotik-wan
    name: ether1
    type: ethernet
    speed_mbps: 2500
    role: wan
    description: 2.5 GbE WAN port - connects to ISP
  - id: if-mikrotik-lan1
    name: ether2
    type: ethernet
    speed_mbps: 1000
    role: lan
    description: LAN port 1 - Proxmox
  - id: if-mikrotik-lan2
    name: ether3
    type: ethernet
    speed_mbps: 1000
    role: lan
    description: LAN port 2 - Orange Pi 5
  - id: if-mikrotik-lan3
    name: ether4
    type: ethernet
    speed_mbps: 1000
    role: lan
    description: LAN port 3 - reserved
  - id: if-mikrotik-lan4
    name: ether5
    type: ethernet
    speed_mbps: 1000
    role: lan
    description: LAN port 4 - reserved
  - id: if-mikrotik-wlan-5g
    name: wlan1
    type: wifi-5ghz
    speed_mbps: 1200
    standard: 802.11ax
    chipset: QCN-5052
    chains: 2
    antenna_gain_dbi: 6
    description: WiFi 6 5GHz (main)
  - id: if-mikrotik-wlan-2g
    name: wlan2
    type: wifi-2.4ghz
    speed_mbps: 574
    standard: 802.11ax
    chipset: QCN-5022
    chains: 2
    antenna_gain_dbi: 3
    description: WiFi 6 2.4GHz (compatibility)
  - id: if-mikrotik-lte
    name: lte1
    type: lte
    modem: R11e-LTE7
    category: 7
    speed_dl_mbps: 300
    speed_ul_mbps: 100
    mimo_dl: 2x2
    mimo_ul: 1x1
    sim_type: Micro-SIM
    lte_bands_fdd:
    - 1
    - 3
    - 5
    - 7
    - 8
    - 20
    - 28
    - 32
    lte_bands_tdd:
    - 38
    - 40
    - 41
    bands_3g:
    - 1
    - 3
    - 5
    - 8
    role: wan-failover
    description: LTE Cat 7 modem for failover
  power:
    input_voltage: 12-28V DC
    max_watts: 21.5
    typical_watts: 15.5
    cooling: passive
  firmware:
    os: RouterOS
    version: v7
    license_level: 4
    features:
    - Container support (Docker-compatible)
    - WireGuard VPN
    - ZeroTier
    - REST API
    - TR-069
    - IPsec
- id: orangepi5
  name: Orange Pi 5
  type: sbc
  role: application-server
  model: Orange Pi 5
  location: home
  description: Dedicated application server for Nextcloud, Jellyfin, monitoring
  source: http://www.orangepi.org/html/hardWare/computerAndMicrocontrollers/details/Orange-Pi-5.html
  specs:
    soc: Rockchip RK3588S (8nm LP process)
    pmu: RK806-1
    cpu:
      model: Rockchip RK3588S
      architecture: ARM64
      cores: 8
      design: Big.LITTLE Architecture
      cores_big: 4
      cores_big_model: Cortex-A76
      cores_big_speed_mhz: 2400
      cores_little: 4
      cores_little_model: Cortex-A55
      cores_little_speed_mhz: 1800
      process_nm: 8
    gpu:
      model: ARM Mali-G610 MP4 Odin
      cores: 4
      opengl_es: 1.1/2.0/3.2
      opencl: '2.2'
      vulkan: '1.2'
      features:
      - 3D graphics engine
      - 2D graphics engine
    npu:
      model: Built-in AI accelerator NPU
      tops: 6
      operations:
      - INT4
      - INT8
      - INT16
      note: Mixed operation support
    vpu:
      h265_decode: 8K@60fps
      h264_decode: 8K@30fps
      h265_encode: 8K@30fps
      note: Hardware transcoding for Jellyfin
    memory:
      options_gb:
      - 4
      - 8
      - 16
      selected_gb: 8
      type: LPDDR4/4X
    storage:
      qspi_nor_flash_mb: 16
      microsd_slot: true
      m2_slot: true
      m2_key: M-Key
      m2_support:
      - PCIe NVMe SSD
      - Custom PCIe WiFi6+BT5.0 module
      nvme_planned_gb: 256
  interfaces:
  - id: if-opi5-eth
    name: eth0
    type: ethernet
    speed_mbps: 1000
    speeds_supported:
    - 10
    - 100
    - 1000
    role: lan
    description: 10/100/1000Mbps Gigabit Ethernet
  - id: if-opi5-usb3
    name: usb3
    type: usb
    speed_mbps: 5000
    standard: USB 3.0
    connector: Type-A
    count: 1
    description: USB 3.0 Type-A x1
  - id: if-opi5-usb2
    name: usb2
    type: usb
    speed_mbps: 480
    standard: USB 2.0
    connector: Type-A
    count: 2
    description: USB 2.0 Type-A x2
  - id: if-opi5-usbc
    name: usbc
    type: usb-c
    speed_mbps: 10000
    standard: USB 3.1
    role: power + data + display
    description: Type-C USB3.1 (power, data, DP1.4 Alt Mode)
    features:
    - Power delivery (5V@4A)
    - USB 3.1 data
    - DisplayPort 1.4 Alt Mode
    note: DP1.4 and USB3.1 multiplexed on same port
  - id: if-opi5-hdmi
    name: hdmi
    type: hdmi
    version: '2.1'
    resolution: 8K@60Hz
    audio: eARC
    description: HDMI 2.1 output with eARC
  - id: if-opi5-mipi-dsi
    name: mipi-dsi
    type: display
    lanes: 4
    count: 2
    resolution: 4K@60Hz
    description: 2x MIPI D-PHY TX 4Lane for displays
  - id: if-opi5-mipi-csi
    name: mipi-csi
    type: camera
    lanes: 4
    count: 2
    description: MIPI CSI 4Lane + 2x MIPI D-PHY RX 4Lane for cameras
  - id: if-opi5-gpio
    name: gpio
    type: expansion
    description: Expansion port for UART, PWM, I2C, SPI, CAN and GPIO
  - id: if-opi5-audio
    name: audio
    type: audio
    codec: ES8388
    features:
    - 3.5mm headphone jack (input/output)
    - Onboard MIC
    - HDMI 2.1 eARC
    description: Audio codec with 3.5mm jack and onboard mic
  - id: if-opi5-debug
    name: uart-debug
    type: debug
    pins: 3
    description: 3 Pin debug serial port (UART)
  buttons:
  - name: MaskROM
    type: recovery
  - name: Recovery
    type: recovery
  - name: On/Off
    type: power
  leds:
  - name: Power
    color: red
  - name: Status
    color: green
  cooling:
    fan_voltage: 5V
    fan_connector: true
  power:
    input: Type-C
    voltage: 5V
    current: 4A
    watts: 20
    connector: USB Type-C
  os:
    official:
    - Orange Pi OS (Droid)
    - Orange Pi OS (Arch)
    - Ubuntu
    - Debian
    - Android 12
    planned: Debian 12
- id: slate-ax1800
  name: GL.iNet Slate AX
  type: router
  role: travel-router
  model: GL-AXT1800
  location: portable
  description: Travel router for remote access to home network
  specs:
    cpu:
      model: MediaTek MT7981B
      cores: 2
      speed_mhz: 1300
    memory:
      total_mb: 512
      type: DDR4
    storage:
      flash_mb: 128
      type: NAND
  interfaces:
  - id: if-slate-wan
    name: wan
    type: ethernet
    speed_mbps: 1000
    role: wan
    description: WAN port
  - id: if-slate-lan
    name: lan
    type: ethernet
    speed_mbps: 1000
    role: lan
    description: LAN port
  - id: if-slate-wlan-5g
    name: wlan0
    type: wifi-5ghz
    speed_mbps: 1200
    standard: 802.11ax
    description: WiFi 6 5GHz
  - id: if-slate-wlan-2g
    name: wlan1
    type: wifi-2.4ghz
    speed_mbps: 574
    standard: 802.11ax
    description: WiFi 6 2.4GHz
  firmware:
    version: 4.8.2
    base: OpenWRT 23.05
    updated: '2024-11-15'
  travel_features:
  - WireGuard client to home network
  - Repeater mode for hotel WiFi
  - Portable VPN gateway

# Cloud Servers
- id: oracle-arm-frankfurt
  name: Oracle Cloud ARM (Frankfurt)
  type: cloud-vm
  role: vpn-exit-node
  location: oracle-frankfurt
  description: Oracle Cloud Always Free ARM instance - Жар-птица (огненная птица, символ удачи)
  cloud:
    provider: oracle
    region: eu-frankfurt-1
    availability_zone: EU-FRANKFURT-1-AD-1
    instance_type: VM.Standard.A1.Flex
    vcpus: 4
    memory_gb: 24
    boot_volume_gb: 200
    public_ip: true
    ipv6: true
    pricing:
      tier: free
      monthly_cost: 0
      currency: EUR
    tags:
      purpose: vpn-exit-node
      environment: production
  specs:
    cpu:
      architecture: ARM64
      model: Ampere Altra
      cores: 4
    memory:
      total_gb: 24
      type: DDR4
  interfaces:
  - id: if-oracle-public
    name: ens3
    type: ethernet
    speed_mbps: 1000
    role: wan
    description: Primary public network interface
  services:
  - WireGuard VPN server (exit node for RU traffic)
  - Tailscale relay node
  - Optional: lightweight web services

- id: hetzner-cx22-nuremberg
  name: Hetzner CX22 (Nuremberg)
  type: cloud-vm
  role: cloud-server
  location: hetzner-nuremberg
  description: Hetzner Cloud entry-level VPS - Алконост (птица радости)
  cloud:
    provider: hetzner
    region: nbg1
    instance_type: cx22
    vcpus: 2
    memory_gb: 4
    boot_volume_gb: 40
    public_ip: true
    ipv6: true
    pricing:
      tier: paid
      monthly_cost: 4.35
      currency: EUR
    tags:
      purpose: general-compute
      environment: production
  specs:
    cpu:
      architecture: x86_64
      model: Intel Xeon
      cores: 2
    memory:
      total_gb: 4
      type: DDR4
  interfaces:
  - id: if-hetzner-public
    name: eth0
    type: ethernet
    speed_mbps: 1000
    role: wan
    description: Primary public network interface
  services:
  - Backup VPN endpoint
  - Remote development environment
  - CI/CD runners

ups:
- id: ups-main
  name: Main UPS
  model: APC Back-UPS 650VA
  type: line-interactive
  location: home
  description: Primary UPS for critical infrastructure
  specs:
    capacity_va: 650
    capacity_watts: 390
    battery_type: Sealed Lead Acid
    battery_count: 1
    runtime_full_load_min: 5
    runtime_half_load_min: 15
    input_voltage: 220-240V AC
    output_voltage: 230V AC
    outlets_battery: 4
    outlets_surge: 2
  connection:
    type: usb
    connected_to: orangepi5
    monitoring_software: nut
    driver: usbhid-ups
  protected_devices:
  - device_ref: mikrotik-chateau
    power_watts: 16
    priority: 1
    description: Router - critical for network
  - device_ref: orangepi5
    power_watts: 15
    priority: 2
    description: Application server
  - device_ref: gamayun
    power_watts: 50
    priority: 3
    description: Proxmox server
  total_load_watts: 81
  estimated_runtime_min: 20
  thresholds:
    low_battery_percent: 30
    critical_battery_percent: 15
    shutdown_battery_percent: 10
    overload_percent: 90
  actions:
    on_battery:
    - action: notify
      delay_seconds: 0
      message: UPS on battery power
    - action: log
      delay_seconds: 0
    low_battery:
    - action: notify
      delay_seconds: 0
      message: UPS battery low - prepare for shutdown
    - action: shutdown
      target: gamayun
      delay_seconds: 60
      command: shutdown -h +1
    critical_battery:
    - action: shutdown
      target: orangepi5
      delay_seconds: 30
      command: shutdown -h now
    - action: notify
      message: Critical battery - shutting down servers
    power_restored:
    - action: notify
      message: Power restored
    - action: cancel_shutdown
  monitoring:
    enabled: true
    poll_interval_seconds: 10
    metrics:
    - battery.charge
    - battery.runtime
    - input.voltage
    - output.voltage
    - ups.load
    - ups.status
    - ups.temperature
  notifications:
    channels:
    - email
    - telegram
    events:
    - on_battery
    - low_battery
    - power_restored
    - overload
    - replace_battery
