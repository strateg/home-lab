# Reinstall Prevention - Quick Summary

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ Proxmox —Å USB:
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ USB –Ω–µ –≤—ã–Ω—É—Ç—å ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–Ω–æ–≤–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–æ–∫ ‚ùå

## –†–µ—à–µ–Ω–∏–µ

**UUID-based —à—Ç–∞–º–ø-—Ö—ç—à —Å–∏—Å—Ç–µ–º–∞**:
1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ USB –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π UUID
2. UUID —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ USB –∏ –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ
3. –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ GRUB –ø—Ä–æ–≤–µ—Ä—è–µ—Ç UUID –Ω–∞ –¥–∏—Å–∫–µ
4. –ï—Å–ª–∏ UUID —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Üí –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É (–Ω–µ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç!) ‚úÖ

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (—Å–∏—Å—Ç–µ–º–∞ –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ USB Boot ‚Üí GRUB                        ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ UUID –Ω–∞ –¥–∏—Å–∫–µ...              ‚îÇ
‚îÇ ‚ùå UUID –Ω–µ –Ω–∞–π–¥–µ–Ω (—á–∏—Å—Ç—ã–π –¥–∏—Å–∫)        ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó ‚îÇ
‚îÇ ‚ïë Automated Installation             ‚ïë ‚îÇ
‚îÇ ‚ïë (auto in 10s)                      ‚ïë ‚îÇ
‚îÇ ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Proxmox (~15 –º–∏–Ω)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ UUID —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫:              ‚îÇ
‚îÇ - /etc/proxmox-install-id              ‚îÇ
‚îÇ - /boot/efi/proxmox-installed          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Reboot (USB –µ—â–µ –≤—Å—Ç–∞–≤–ª–µ–Ω)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –í—Ç–æ—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (—Å–∏—Å—Ç–µ–º–∞ –£–ñ–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ USB Boot ‚Üí GRUB                        ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ UUID –Ω–∞ –¥–∏—Å–∫–µ...              ‚îÇ
‚îÇ ‚úÖ UUID –Ω–∞–π–¥–µ–Ω!                        ‚îÇ
‚îÇ ‚úÖ UUID —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å USB                ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó ‚îÇ
‚îÇ ‚ïë Proxmox already installed          ‚ïë ‚îÇ
‚îÇ ‚ïë                                    ‚ïë ‚îÇ
‚îÇ ‚ïë 1. Boot from disk [default]        ‚ïë ‚îÇ
‚îÇ ‚ïë 2. Reinstall (ERASES DISK!)        ‚ïë ‚îÇ
‚îÇ ‚ïë                                    ‚ïë ‚îÇ
‚îÇ ‚ïë Press 'd' - boot (auto in 10s)     ‚ïë ‚îÇ
‚îÇ ‚ïë Press 'r' - REINSTALL              ‚ïë ‚îÇ
‚îÇ ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ß–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥:                       ‚îÇ
‚îÇ ‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ —Å –¥–∏—Å–∫–∞ (chainload)         ‚îÇ
‚îÇ ‚Üí –ù–ï–¢ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏! ‚úÖ                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§–∞–π–ª—ã –Ω–∞ USB

```
/EFI/BOOT/
‚îú‚îÄ‚îÄ install-id              # UUID: a1b2c3d4-e5f6-7890-abcd-ef1234567890
‚îî‚îÄ‚îÄ reinstall-check.cfg     # GRUB —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
```

### –§–∞–π–ª—ã –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ

```
/etc/proxmox-install-id         # UUID (reference)
/boot/efi/proxmox-installed     # UUID (GRUB —á–∏—Ç–∞–µ—Ç —ç—Ç–æ—Ç!)
/var/log/proxmox-install.log    # –õ–æ–≥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
```

### GRUB –ª–æ–≥–∏–∫–∞

```grub
# 1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å UUID —Å –¥–∏—Å–∫–∞
cat --set=installed_uuid ($efipart)/proxmox-installed

# 2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å UUID —Å USB
cat --set=usb_uuid ($root)/EFI/BOOT/install-id

# 3. –°—Ä–∞–≤–Ω–∏—Ç—å
if [ "$installed_uuid" = "$usb_uuid" ]; then
    # –£–ñ–ï –£–°–¢–ê–ù–û–í–õ–ï–ù–û –° –≠–¢–û–ì–û USB
    ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é "Boot from disk"
    ‚Üí –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –¥–∏—Å–∫–∞ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
else
    # –ù–ï–¢ –£–°–¢–ê–ù–û–í–ö–ò –∏–ª–∏ –î–†–£–ì–û–ô USB
    ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é "Install"
    ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
fi
```

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### create-usb.sh

**–ë—ã–ª–æ**: 561 —Å—Ç—Ä–æ–∫–∞
**–°—Ç–∞–ª–æ**: 730 —Å—Ç—Ä–æ–∫ (+169 —Å—Ç—Ä–æ–∫, +30%)

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
- –§—É–Ω–∫—Ü–∏—è `embed_install_uuid()` - 119 —Å—Ç—Ä–æ–∫
- UUID –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ `prepare_iso()` - 20 —Å—Ç—Ä–æ–∫
- First-boot –∫–æ–º–∞–Ω–¥—ã - 17 —Å—Ç—Ä–æ–∫
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ - 25 —Å—Ç—Ä–æ–∫

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- `REINSTALL-PREVENTION.md` - 11 KB (–ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- `CHANGELOG-REINSTALL-PREVENTION.md` - 7.3 KB (changelog)
- `REINSTALL-PREVENTION-SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ main()

```bash
# –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ workflow:
validate_answer_file
prepare_iso          # ‚Üê –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç UUID
write_usb
add_graphics_params
embed_install_uuid   # ‚Üê –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø
verify_usb
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ USB

```bash
cd bare-metal/
sudo ./create-usb.sh /dev/sdb proxmox-ve_9.0-1.iso

# –í—ã–≤–æ–¥:
# ‚úì Generated installation UUID: 550e8400-e29b-41d4-...
# ‚úì UUID saved to: /EFI/BOOT/install-id
# ‚úì Created reinstall-check script
# ‚úì Installation UUID embedded on USB
```

### –ü–µ—Ä–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å USB
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (10 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç)
3. UUID —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫
4. Reboot

### –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (USB –µ—â–µ –≤—Å—Ç–∞–≤–ª–µ–Ω)

1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å USB
2. **GRUB –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç: —Å–∏—Å—Ç–µ–º–∞ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞**
3. –ú–µ–Ω—é: "Boot from disk (Already Installed)" [default]
4. –ß–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Å –¥–∏—Å–∫–∞
5. **–ù–ï–¢ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏!** ‚úÖ

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

**–í–∞—Ä–∏–∞–Ω—Ç 1**: –ù–∞–∂–∞—Ç—å 'r' –≤ GRUB –º–µ–Ω—é

**–í–∞—Ä–∏–∞–Ω—Ç 2**: –£–¥–∞–ª–∏—Ç—å UUID —Å –¥–∏—Å–∫–∞
```bash
ssh root@proxmox-ip
rm /boot/efi/proxmox-installed
reboot
```

**–í–∞—Ä–∏–∞–Ω—Ç 3**: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π USB (–¥—Ä—É–≥–æ–π UUID)

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```
–ù–æ–≤—ã–π –ª–∞–ø—Ç–æ–ø, —á–∏—Å—Ç—ã–π SSD
‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ —Å USB-A
‚Üí –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Proxmox (UUID: aaa-111)
‚Üí UUID —Å–æ—Ö—Ä–∞–Ω–µ–Ω –Ω–∞ –¥–∏—Å–∫
‚Üí Reboot (USB –µ—â–µ –≤—Å—Ç–∞–≤–ª–µ–Ω)
‚Üí GRUB: "Already installed" ‚Üí Boot from disk ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –¢–æ—Ç –∂–µ USB –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
–°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å USB-A (UUID: aaa-111)
‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ —Å USB-A —Å–Ω–æ–≤–∞
‚Üí GRUB: UUID –Ω–∞ –¥–∏—Å–∫–µ = aaa-111, UUID –Ω–∞ USB = aaa-111
‚Üí –°–æ–≤–ø–∞–¥–∞—é—Ç! ‚Üí Boot from disk ‚úÖ
‚Üí –ù–ï–¢ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –î—Ä—É–≥–æ–π USB

```
–°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å USB-A (UUID: aaa-111)
‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ —Å USB-B (UUID: bbb-222)
‚Üí GRUB: UUID –Ω–∞ –¥–∏—Å–∫–µ = aaa-111, UUID –Ω–∞ USB = bbb-222
‚Üí –ù–ï —Å–æ–≤–ø–∞–¥–∞—é—Ç! ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é Install
‚Üí –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º –∂–µ USB

```
–°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å USB-A
‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ —Å USB-A
‚Üí GRUB: "Already installed"
‚Üí –ù–∞–∂–∞—Ç—å 'r' ‚Üí REINSTALL
‚Üí –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è ‚úÖ
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

| –î–æ | –ü–æ—Å–ª–µ |
|----|-------|
| ‚ùå –ù—É–∂–Ω–æ –≤—ã–Ω–∏–º–∞—Ç—å USB —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ | ‚úÖ –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å USB –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º |
| ‚ùå –ó–∞–±—ã–ª –≤—ã–Ω—É—Ç—å USB ‚Üí –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Üí –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö | ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É ‚Üí –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –¥–∏—Å–∫–∞ |
| ‚ùå –ö–∞–∂–¥–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å USB ‚Üí –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å –¥–∏—Å–∫–∞ |
| ‚ùå –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–æ–π | ‚úÖ –Ø–≤–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ('r' key) –¥–ª—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏ |

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–≠—Ç–æ –ù–ï security feature!**

**–¶–µ–ª—å**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å **—Å–ª—É—á–∞–π–Ω—É—é** –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫—É, –Ω–µ –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω—É—é.

**–ú–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏**:
- –£–¥–∞–ª–∏—Ç—å `/boot/efi/proxmox-installed`
- –°–æ–∑–¥–∞—Ç—å –¥—Ä—É–≥–æ–π USB
- –ù–∞–∂–∞—Ç—å 'r' –≤ –º–µ–Ω—é

**UUID –Ω–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è** - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —É–¥–æ–±—Å—Ç–≤–∞, –Ω–µ –∑–∞—â–∏—Ç—ã.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**Checklist**:
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —á–∏—Å—Ç—ã–π –¥–∏—Å–∫ ‚Üí UUID —Å–æ—Ö—Ä–∞–Ω–µ–Ω
- [ ] –í—Ç–æ—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Ç–æ–≥–æ –∂–µ USB ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Å –¥–∏—Å–∫–∞
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Å –¥—Ä—É–≥–æ–≥–æ USB ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é Install
- [ ] –ù–∞–∂–∞—Ç–∏–µ 'r' ‚Üí –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ UUID —Å –¥–∏—Å–∫–∞ ‚Üí –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∏—Å—Ç–µ–º–∞ –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```bash
ssh root@proxmox-ip
cat /boot/efi/proxmox-installed
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å UUID, –Ω–∞–ø—Ä–∏–º–µ—Ä: a1b2c3d4-e5f6-7890...
```

**–ï—Å–ª–∏ —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç**:
```bash
# –ü–æ–ª—É—á–∏—Ç—å UUID —Å USB (mount it first)
USB_UUID=$(cat /mnt/EFI/BOOT/install-id)

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ –¥–∏—Å–∫
echo "$USB_UUID" > /boot/efi/proxmox-installed
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –º–æ–≥—É –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —Å –¥–∏—Å–∫–∞ (chainloader fails)

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–º–µ—Ä EFI —Ä–∞–∑–¥–µ–ª–∞
```grub
# –í GRUB –º–µ–Ω—é –Ω–∞–∂–∞—Ç—å 'c' –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏
ls
ls (hd0,gpt1)/EFI
ls (hd0,gpt2)/EFI
ls (hd0,gpt3)/EFI

# –ù–∞–π—Ç–∏ —Ä–∞–∑–¥–µ–ª —Å /EFI/proxmox/grubx64.efi
# –û–±–Ω–æ–≤–∏—Ç—å reinstall-check.cfg –Ω–∞ USB:
set root=(hd0,gptN)  # –≥–¥–µ N - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä
```

## –°—Ç–∞—Ç—É—Å

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**: UUID-based reinstall prevention
‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ**: –°–∏–Ω—Ç–∞–∫—Å–∏—Å bash –ø—Ä–æ–≤–µ—Ä–µ–Ω
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ**: 3 —Ñ–∞–π–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (28 KB)

**–§–∞–π–ª—ã**:
- `create-usb.sh`: 730 —Å—Ç—Ä–æ–∫ (–±—ã–ª–æ 561)
- `REINSTALL-PREVENTION.md`: 11 KB (–ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- `CHANGELOG-REINSTALL-PREVENTION.md`: 7.3 KB
- `REINSTALL-PREVENTION-SUMMARY.md`: —ç—Ç–æ—Ç —Ñ–∞–π–ª

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

---

**–î–∞—Ç–∞**: 2025-10-10
**–í–µ—Ä—Å–∏—è**: 1.0
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: Proxmox VE 9.x, GRUB 2.x, UEFI
