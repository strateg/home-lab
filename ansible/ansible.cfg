# Ansible Configuration
# Home Lab Infrastructure
# Dell XPS L701X - Proxmox VE 9

[defaults]

# Inventory - use generated inventory from topology.yaml
# Manual override: ansible-playbook -i /path/to/custom/hosts.yml
inventory = ../generated/ansible/inventory/production/hosts.yml

# Roles path
roles_path = ./roles:~/.ansible/roles:/usr/share/ansible/roles

# Collections path
collections_path = ./collections:~/.ansible/collections

# Host key checking (disabled for lab environment)
host_key_checking = False

# SSH timeout
timeout = 30

# Retry files (disabled)
retry_files_enabled = False

# Gathering facts
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts
fact_caching_timeout = 86400

# Display
stdout_callback = yaml
# Alternative: stdout_callback = minimal, oneline, debug
callbacks_enabled = profile_tasks, timer

# Ansible connection
# Use ssh for connections
connection = ssh

# Become settings
become = True
become_method = sudo
become_user = root
become_ask_pass = False

# Privilege escalation
become_flags = -H -S

# Logging
log_path = ./ansible.log

# Error handling
any_errors_fatal = False

# Parallelism
# Run up to 10 tasks in parallel
forks = 10
# 0 = use all hosts (or specify number)
serial = 0

# Polling
poll_interval = 15

# Pipelining (performance optimization)
pipelining = True

# Control persistence
control_path_dir = ~/.ansible/cp
control_path = %(directory)s/ansible-ssh-%%h-%%p-%%r

# Deprecation warnings
deprecation_warnings = True
command_warnings = False

# Diff mode
diff_always = False

# Callback plugins
callback_whitelist = profile_tasks, timer, yaml

# ============================================================
# Ansible Vault
# ============================================================

# Vault password file (NEVER commit this to git!)
# Create: echo "YOUR_VAULT_PASSWORD" > .vault_pass && chmod 600 .vault_pass
vault_password_file = .vault_pass

# Alternative: Use vault_identity_list for multiple vaults
# vault_identity_list = dev@.vault_pass_dev, prod@.vault_pass_prod

# Vault encryption algorithm
# Options: AES256 (default), AES128
vault_encrypt_identity = default

# Ask for vault password if file not found (safety)
# Set to False to fail if vault_password_file missing
ask_vault_pass = False

# Action plugins
action_plugins = /usr/share/ansible/plugins/action:~/.ansible/plugins/action

# ============================================================
# SSH Settings
# ============================================================

[ssh_connection]

# SSH arguments
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null

# Pipelining (reduces SSH connections)
pipelining = True

# SCP/SFTP
scp_if_ssh = smart
transfer_method = smart

# ControlPath
control_path_dir = ~/.ansible/cp
control_path = %(directory)s/ansible-ssh-%%h-%%p-%%r

# Retries
retries = 3

# ============================================================
# Privilege Escalation
# ============================================================

[privilege_escalation]

become = True
become_method = sudo
become_user = root
become_ask_pass = False

# ============================================================
# Colors
# ============================================================

[colors]

highlight = white
verbose = blue
warn = bright purple
error = red
debug = dark gray
deprecate = purple
skip = cyan
unreachable = red
ok = green
changed = yellow
diff_add = green
diff_remove = red
diff_lines = cyan

# ============================================================
# Inventory
# ============================================================

[inventory]

# Enable plugins
enable_plugins = host_list, script, auto, yaml, ini, toml

# Ignore files
unparsed_is_failed = False

# ============================================================
# Diff
# ============================================================

[diff]

# Always show diff
always = False

# Context lines
context = 3
