# QoS Topology

**Generated from**: topology.yaml v{{ topology_version }}
**Date**: {{ generated_at }}

---

## QoS Traffic Classes

{% if use_mermaid_icons %}
> {{ mermaid_icon_runtime_hint }}
{% endif %}

```mermaid
flowchart TB
    {% if use_mermaid_icons %}
    internet@{ icon: "mdi:cloud-outline", form: "circle", label: "WAN {{ qos.interface | default('interface') }} {{ qos.total_bandwidth.download_mbps | default('?') }} down / {{ qos.total_bandwidth.upload_mbps | default('?') }} up Mbps", pos: "b", h: 46 }
    {% else %}
    internet["WAN / {{ qos.interface | default('interface') }}<br/>{{ qos.total_bandwidth.download_mbps | default('?') }} down / {{ qos.total_bandwidth.upload_mbps | default('?') }} up Mbps"]
    {% endif %}

    subgraph scheduler["Queue Scheduler"]
        direction TB
        {% for queue in qos.queues | default([]) %}
        {% if use_mermaid_icons %}
        {{ queue.id | mermaid_id }}@{ icon: "mdi:chart-bar", form: "rounded", label: "P{{ queue.priority }} {{ queue.name }} G{{ queue.guarantee_percent }}% / M{{ queue.max_limit_percent }}%", pos: "b", h: 44 }
        {% else %}
        {{ queue.id | mermaid_id }}["P{{ queue.priority }} {{ queue.name }}<br/>G{{ queue.guarantee_percent }}% / M{{ queue.max_limit_percent }}%"]
        {% endif %}
        {% endfor %}
    end

    subgraph netlimits["Per-Network Limits"]
        {% for limit in qos.device_limits | default([]) %}
        {% if use_mermaid_icons %}
        {{ limit.network_ref | mermaid_id }}@{ icon: "{{ limit_icons.get(limit.network_ref, 'mdi:lan') }}", form: "rounded", label: "{{ limit.network_ref }} {{ limit.download_limit_mbps }} down / {{ limit.upload_limit_mbps }} up Mbps", pos: "b", h: 44 }
        {% else %}
        {{ limit.network_ref | mermaid_id }}["{{ limit.network_ref }}<br/>{{ limit.download_limit_mbps }} down / {{ limit.upload_limit_mbps }} up Mbps"]
        {% endif %}
        {% endfor %}
    end

    internet --> scheduler
    {% for queue in qos.queues | default([]) %}
    scheduler --> {{ queue.id | mermaid_id }}
    {% endfor %}
    {% for limit in qos.device_limits | default([]) %}
    scheduler --> {{ limit.network_ref | mermaid_id }}
    {% endfor %}

    classDef wan fill:#74c0fc,stroke:#1864ab,color:#000
    classDef queue fill:#51cf66,stroke:#2b8a3e,color:#000
    classDef limit fill:#ffd43b,stroke:#fab005,color:#000

    class internet wan
    {% for queue in qos.queues | default([]) %}
    class {{ queue.id | mermaid_id }} queue
    {% endfor %}
    {% for limit in qos.device_limits | default([]) %}
    class {{ limit.network_ref | mermaid_id }} limit
    {% endfor %}
```

---

## QoS Global Settings

| Setting | Value |
|---------|-------|
| Enabled | {{ 'Yes' if qos.enabled else 'No' }} |
| Device | {{ qos.device_ref | default('-') }} |
| Interface | {{ qos.interface | default('-') }} |
| Download | {{ qos.total_bandwidth.download_mbps | default('-') }} Mbps |
| Upload | {{ qos.total_bandwidth.upload_mbps | default('-') }} Mbps |

---

## Queue Details

| Priority | Queue | Guarantee | Max Limit | Burst | DSCP | Protocols | Ports |
|----------|-------|-----------|-----------|-------|------|-----------|-------|
{% for queue in qos.queues | default([]) | sort(attribute='priority') %}
| {{ queue.priority }} | {{ queue.name }} | {{ queue.guarantee_percent }}% | {{ queue.max_limit_percent }}% | {{ queue.burst_limit_percent | default('-') }}{% if queue.burst_limit_percent is defined %}%{% endif %} | {{ queue.dscp_mark | default('-') }} | {{ queue.protocols | join(', ') if queue.protocols else '-' }} | {{ queue.ports | join(', ') if queue.ports else '-' }} |
{% endfor %}

---

## Per-Network Limits

| Network | Download | Upload | Per Host | Description |
|---------|----------|--------|----------|-------------|
{% for limit in qos.device_limits | default([]) %}
| {{ limit.network_ref }} | {{ limit.download_limit_mbps }} Mbps | {{ limit.upload_limit_mbps }} Mbps | {{ 'Yes' if limit.per_host_limit else 'No' }} | {{ limit.description | default('-') }} |
{% endfor %}

---

**DO NOT EDIT MANUALLY** - Regenerate with `python3 topology-tools/generate-docs.py`
